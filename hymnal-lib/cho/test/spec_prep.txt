Препроцессор (далее ПП) служит для расширения функционала формата .cho. Он позволяет хранить в одном тексте 2 различных версии аккордов
 (в дальнейшем предпологается, что одна из них является "для служебного пользования", сокращённо ДСП, вторая -- упрощённая, сокращённо УПР)
и упрощает расстановку аккордов по тексту, а именно -- в случае, когда аккорды в различных куплетах точно повторяются, можно разметить
только один из них, а в последующем ограничиться лишь указанием позиций в тексте, на которые необходимо вставить аккорды. Исходными данными
для работы ПП является текстовый файл формата .inb и версия аккордов: упр или дсп. Результатом работы является файл формата .cho

ПП работает с текстом как с длинной последовательностью символов, без учёта деления на строки. Преобразование файлов происходит в II этапа
I этап
На первом этапе ПП получает требуемую версию аккордов: УПР или ДСП. При этом он обрабатывает 4 вида токенов (применяются всё-таки квадратные скобки,
потому что фигурные уже используются форматом .cho):
1. [chordA|chordB] заменится на [chordA] в режиме ДСП и на [chordB] в режиме УПР 
2. [chord|] заменится на [chord] в режиме ДСП и удалится в режиме УПР
3. [|chord] заменится на [chord] в режиме УПР и удалится в режиме ДСП
4. [chordA] остаётся без изменений в любом режиме и фактически является более простым синтаксисом для [chordA:chordA] 

пример
Текст
 "[F]Свя[Am/E|Am]тый Гос[Dm]подь, Ты О[B|Bb]дин лишь [Gm]совер[Csus|C]шенен![C|]"
после этапа I превратится в 
-- в режиме ДСП: "[F]Свя[Am/E]тый Гос[Dm]подь, Ты О[B]дин лишь [Gm]совер[Csus]шенен![C]"
-- в режиме УПР: "[F]Свя[Am]тый Гос[Dm]подь, Ты О[Bb]дин лишь [Gm]совер[C]шенен!"

II этап
На втором этапе производится расстановка аккордов по образцу. Для выполнения подобной расстановки в тексте должно быть два региона: эталонный и подстановочный

Эталонный регион представляет собой регион текста, ограниченный токенами <+c, где c -- десятичная цифра от 0 до 9 называемая номером региона, и c+>, 
и не содержащий между ними других токенов
вида "<+c" "c+>" "<-c" "c->" "%" "$" . Несоблюдение этого требования ведёт к остановке ПП. К моменту начала этапа II текстовый регион должен содержать только аккорды в виде [chord],
 версии ДСП или УПР в количестве Nдсп либо Nупр соответственно.
 
Подстановочный регион представляет собой регион текста, ограниченный токенами <-c, где c -- десятичная цифра от 0 до 9 называемая номером региона, и c->, содержащий
--Nдсп токенов "$"
--Nупр токенов "%" 
где Nдсп, Nупр -- количество аккордов в эталонном регионе с номером c в режиме ДСП, УПР соответственно --
и не содержащий между ними токенов вида "<+c" "c+>" "<-c" "c->. Невыполнение этого требования ведёт к остановке ПП.

В каждом подстановочном районе номер c символы "$" в ДСП режиме или "%" в УПР режиме заменяются по порядку аккордами из эталонного региона номер c.После этого все служебные 
токены удаляются из текста.В тексте может быть максимум один эталонный регион номер c и неограниченно много подстановочных регионов номер c. Эталонный регион может располагаться 
в любом месте текста.

Пример

Пусть текст в ДСП режиме после этапа II имеет вид
<+0[F]Свя[Am/E]тый Гос[Dm]подь, Ты О[B]дин лишь [Gm]совер[Csus]шенен![C]0+>
<-0$Гл%асу$ Тво%ему$ вне%млем$ мы %в $%благо$говении%$0->
после выполнения этапа II текст будет иметь вид
[F]Гласу[Am/E] Твоему[Dm] внемлем[B] мы в [Gm]благ[Csus]оговении[C]
